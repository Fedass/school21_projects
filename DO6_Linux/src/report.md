# Отчет по выполнению проекта DO6_CICD


### Part 1. Настройка **gitlab-runner**

1. ##### Скачал и установил на виртуальную машину **gitlab-runner**.

![1-1](images/image1.1.png)
> Скачал файлы gitlab-runner_amd64.deb и gitlab-runner-helper-images.deb

![1-2](images/image1.2.png)
> Установил файлы gitlab-runner_amd64.deb и gitlab-runner-helper-images.deb

![1-3](images/image1.3.png)
> Успешная установка

2. ##### Запустил **gitlab-runner** и зарегистрировал его для использования в текущем проекте (*DO6_CICD*).

![1-4](images/image1.4.png)
> Запуск и регистрация 


### Part 2. Сборка

1. ##### Написал этап для **CI** по сборке приложений из проекта *C2_SimpleBashUtils*.
В файле _gitlab-ci.yml_ добавил этап запуска сборки через мейк файл из проекта _C2_.

![2-1](images/image2.1.png)
> build

2. ##### Запушил файлы и проверил pipelines на gitlab.

![2-2](images/image2.2.png)
> Успешный pipeline

![2-3](images/image2.3.png)
> Вывод в jobs в результате сборки

3. ##### Файлы, полученные после сборки (артефакты), сохрани в произвольную директорию со сроком хранения 30 дней.

![2-4](images/image2.4.png)
> Артефакты


### Part 3. Тест кодстайла

1. ##### Написал этап для **CI**, который запускает скрипт кодстайла (*clang-format*).

![3-1](images/image3.1.png)
> clang test

2. ##### Запушил файлы и проверил pipelines на gitlab.

![3-2](images/image3.2.png)
> Успешный pipeline

![3-3](images/image3.3.png)
> Вывод в jobs в результате сборки


### Part 4. Интеграционные тесты

1. #### Написал этап для **CI**, который запустит интеграционные тесты.

![4-1](images/image4.1.png)
> tests

2. ##### Запушил файлы и проверил pipelines на gitlab. 

![4-2](images/image4.2.png)
> Успешный pipeline

![4-3](images/image4.3.png)
> Вывод в jobs в результате тестов cat

![4-4](images/image4.4.png)
> Вывод в jobs в результате тестов grep

### Part 5. Этап деплоя

1. #### Написал этап для **CD**, который «разворачивает» проект на другой виртуальной машине.

![5-1](images/image5.1.png)
> Этап деплоя

2. ##### Написал bash-скрипт, который при помощи **ssh** и **scp** копирует файлы, полученные после сборки (артефакты), в директорию */usr/local/bin* второй виртуальной машины.

![5-2](images/image5.2.png)
> run_deploy.sh

3. #### Выполнил настройку сервиса ssh на двух машинах. Добавил SSH-ключи для GitLab Runner на локальной маишне. Скопировал публичный ключ на удаленную машину.

![5-3](images/image5.3.png)
> ssh-copy-id 

4. #### Зашел на удаленный сервер. Если заходит без пароля - все настроено правильно.

![5-4](images/image5.4.png)
> ssh

5. #### Запустил этот этап вручную при условии, что все предыдущие этапы прошли успешно.

![5-5](images/image5.5.png)
> Успешный pipeline

![5-6](images/image5.6.png)
> Вывод в job

![5-7](images/image5.7.png)
> Файлы на удаленном сервере в usr/local/bin

6. ##### Сохранил дампы образов виртуальных машин.

![5-8](images/image5.9.png)
> Дампы машин